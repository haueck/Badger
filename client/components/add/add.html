<div>
  <modal :title="'Select a tag'" id="modal-add-tag">
    <div v-if="tags[tag]['Children'].length == 0">No tags yet</div>
    <div v-for="(name, index) in tags[tag]['Children']" v-if="!tags[name]['Inactive']" :class="{ 'border-top': index != 0 }" class="tag-select">
      <div class="tag-name p-3" @click="addTags(name)" data-dismiss="modal">{{ name }}</div>
      <div v-if="tags[name]['Children'].length" class="tag-children p-3 fas fa-chevron-right" @click=setParent(name)></div>
    </div>
    <template v-slot:footer>
      <button type="button" class="btn btn-primary" @click="showCreate()">Create a new tag</button>
      <button type="button" class="btn btn-secondary" v-if="tag != '€'" @click="back()">Back</button>
      <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
    </template>
  </modal>
  <modal :closing="false" :title="'Select a parent'" id="modal-select-parent">
    <div v-for="(name, index) in tags[tag]['Children']" v-if="!tags[name]['Inactive']" :class="{ 'border-top': index != 0 }" class="tag-select">
      <div class="tag-name p-3" @click="selectParent(name)">{{ name }}</div>
      <div v-if="tags[name]['Children'].length" class="tag-children p-3 fas fa-chevron-right" @click=setParent(name)></div>
    </div>
    <template v-slot:footer>
      <button type="button" class="btn btn-primary" @click="switchModals('modal-select-parent', 'modal-create-tag')">Create here</button>
      <button type="button" class="btn btn-secondary" v-if="tag != '€'" @click=back()>Back</button>
    </template>
  </modal>
  <modal :closing="false" :title="'Create a new tag'" id="modal-create-tag">
    <div class="form-inline p-3">
      <label class="text-secondary mr-2">{{ path }}</label>
      <input type="text" class="form-control" @keyup.enter="createTag" pattern="^[^~\*\/\[\]\.]+$" placeholder="Tag name" required/>
      <div class="invalid-feedback">The name must not be empty and must not contain .~*/[]</div>
    </div>
    <template v-slot:footer>
      <button type="button" class="btn btn-secondary" @click="cancelCreate()">Close</button>
      <button type="button" class="btn btn-primary" @click="changeParent()">Change parent</button>
      <button type="button" class="btn btn-primary" @click="createTag()">Create</button>
    </template>
  </modal>
  <modal :title="'Remove the card'" id="modal-card-remove">
    <span>Are you sure?</span>
    <template v-slot:footer>
      <button type="button" class="btn btn-danger" @click="removeCard()">Yes</button>
      <button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>
    </template>
  </modal>
  <ul v-if="!editing" class="nav nav-pills mb-3">
    <li class="nav-item">
      <span class="nav-link mr-2" :class="{ active: card['Type'] == 'English' }" @click="changeType('English')">English</span>
    </li>
    <li class="nav-item">
      <span class="nav-link mr-2" :class="{ active: card['Type'] == 'Question' }" @click="changeType('Question')">Question</span>
    </li>
    <li class="nav-item">
      <span class="nav-link mr-2" :class="{ active: card['Type'] == 'Reminder' }" @click="changeType('Reminder')">Reminder</span>
    </li>
    <li class="nav-item">
      <span class="nav-link" :class="{ active: card['Type'] == 'MultipleChoice' }" @click="changeType('MultipleChoice')">Multiple Choice</span>
    </li>
  </ul>
  <div v-if="card['Type']">
    <div>
      <div v-for="tag in card['Tags']" class="btn-group mr-2">
        <button type="button" class="btn btn-info" disabled>{{ tag }}</button>
        <button type="button" class="btn btn-info" @click="removeTag(tag)">
          <span class="fas fa-times"></span>
        </button>
      </div>
      <button type="button" class="btn btn-primary" @click="showTags()">Add a tag</button>
    </div>
    <component :is="currentComponent" :card="card"></component>
    <div v-if="editing">
      <div>
        <input type="checkbox" v-model="card['Disabled']"> Disabled
      </div>
      <div>
        Schedule for:
        <input type="date" v-model="card['ScheduledFor']" class="form-control">
      </div>
      <button class="btn btn-primary" @click="finalizeCard()">Update</button>
      <button class="btn btn-danger" @click="confirmRemove()">Delete</button>
    </div>
    <div v-else>
      <button class="btn btn-primary" @click="finalizeCard()">Create</button>
    </div>
  </div>
</div>
